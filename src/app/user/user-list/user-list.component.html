<!-- <div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>User List</h2>

    <div class="mb-3">
      <label class="me-2 fw-bold">Status:</label>
      <div class="form-check form-check-inline" *ngFor="let s of statusOptions">
        <input
          class="form-check-input"
          type="radio"
          name="statusFilter"
          [id]="s.value + 'Status'"
          [value]="s.value"
          [(ngModel)]="statusFilter"
          (change)="onStatusChange()"
        />
        <label class="form-check-label" [for]="s.value + 'Status'">
          {{ s.label | titlecase }}
        </label>
      </div>
    </div>

    <div class="mb-3 d-flex align-items-center">
      <label class="ms-3 me-2 fw-bold">Role:</label>
      <select
        class="form-select d-inline-block w-auto"
        [(ngModel)]="roleFilter"
        (change)="onRoleChange()"
      >
        <option [ngValue]="'all'">All</option>
        <option *ngFor="let role of roleOptions" [ngValue]="role">
          {{ getRoleName(role) }}
        </option>
      </select>
    </div>

    <button class="btn btn-success" (click)="onAddUser()">Add User</button>
  </div>

  <div class="mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="Search by name, email or phone..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="onSearchChange($event)"
    />
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-hover table-bordered">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Name</th>
          <th>Age</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Address</th>
          <th>Registered Date</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of displayedUsers; let i = index">
          <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
          <td>{{ user.name }}</td>
          <td>{{ user.age }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.phone }}</td>
          <td>{{ user.address }}</td>
          <td>{{ user.registeredDate }}</td>
          <td>
            <span class="badge" [ngClass]="getRoleClass(user.role)">
              {{ getRoleName(user.role) }}
            </span>
          </td>
          <td>
            <span
              class="badge"
              [ngClass]="user.isActive ? 'bg-success' : 'bg-danger'"
              (click)="onToggleStatus(user)"
              style="cursor: pointer"
            >
              {{ user.isActive ? "Active" : "Inactive" }}
            </span>
          </td>
          <td>
            <button
              class="btn btn-primary btn-sm me-1"
              (click)="onEditUser(user)"
              *ngIf="user.isActive"
            >
              Edit
            </button>
            <button
              class="btn btn-danger btn-sm"
              (click)="onDeleteUser(user)"
              *ngIf="!user.isActive"
            >
              Delete
            </button>
          </td>
        </tr>
        <tr *ngIf="displayedUsers.length === 0">
          <td colspan="10" class="text-center">No users found.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <app-pagination
    [totalItems]="totalUsers"
    [itemsPerPage]="itemsPerPage"
    [currentPage]="currentPage"
    (pageChange)="onPaginationChange($event)"
  ></app-pagination>
</div> -->

<!-- 
<div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>User List</h2>

    <div class="mb-3">
      <label class="me-2 fw-bold">Status:</label>
      <div class="form-check form-check-inline" *ngFor="let s of statusOptions">
        <input
          class="form-check-input"
          type="radio"
          name="statusFilter"
          [id]="s.value + 'Status'"
          [value]="s.value"
          [(ngModel)]="statusFilter"
          (change)="onStatusChange()"
        />
        <label class="form-check-label" [for]="s.value + 'Status'">
          {{ s.label | titlecase }}
        </label>
      </div>
    </div>

    <div class="mb-3 d-flex align-items-center">
      <label class="ms-3 me-2 fw-bold">Role:</label>
      <select
        class="form-select d-inline-block w-auto"
        [(ngModel)]="roleFilter"
        (change)="onRoleChange()"
      >
        <option [ngValue]="'all'">All</option>
        <option *ngFor="let role of roleOptions" [ngValue]="role">
          {{ getRoleName(role) }}
        </option>
      </select>
    </div>

    <button class="btn btn-success" (click)="onAddUser()">Add User</button>
  </div>

  <div class="mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="Search by name, email or phone..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="onSearchChange($event)"
    />
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-hover table-bordered">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Name</th>
          <th>Age</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Address</th>
          <th>Registered Date</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of displayedUsers; let i = index">
          <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
          <td *ngIf="inlineEditUserId !== user.id">{{ user.name }}</td>
          <td *ngIf="inlineEditUserId === user.id">
            <input type="text" class="form-control form-control-sm" formControlName="name">
          </td>
          <td>{{ user.age }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.phone }}</td>
          <td>{{ user.address }}</td>
          <td>{{ user.registeredDate }}</td>
          <td>
            <span class="badge" [ngClass]="getRoleClass(user.role)">
              {{ getRoleName(user.role) }}
            </span>
          </td>
          <td>
            <span
              class="badge"
              [ngClass]="user.isActive ? 'bg-success' : 'bg-danger'"
              style="cursor: pointer"
            >
              {{ user.isActive ? "Active" : "Inactive" }}
            </span>
          </td>
          <td>
            <ng-container *ngIf="inlineEditUserId !== user.id">
              <button
                class="btn btn-primary btn-sm me-1"
                (click)="onEditUser(user)"
                *ngIf="user.isActive"
              >
                Edit
              </button>

              <button
                class="btn btn-danger btn-sm"
                (click)="onDeleteUser(user)"
                *ngIf="!user.isActive"
              >
                Delete
              </button>

              <button
                class="btn btn-secondary btn-sm me-1"
                (click)="onToggleStatus(user)"
              >
                {{ user.isActive ? "Inactive" : "Active" }}
              </button>

              <button
                class="btn btn-sm btn-warning me"
                (click)="onInlineEdit(user)"
              >
                Inline Edit
              </button>
            </ng-container>

            <ng-container *ngIf="inlineEditUserId === user.id">
              <button class="btn btn-primary btn-sm me-1">Save</button>
              <button class="btn btn-danger btn-sm">Cancel</button>
            </ng-container>
          </td>
        </tr>
        <tr *ngIf="displayedUsers.length === 0">
          <td colspan="10" class="text-center">No users found.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <app-pagination
    [totalItems]="totalUsers"
    [itemsPerPage]="itemsPerPage"
    [currentPage]="currentPage"
    (pageChange)="onPaginationChange($event)"
  ></app-pagination>
</div> -->
<div class="container my-5">
  <!-- Filters -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>User List</h2>

    <!-- Status -->
    <div class="mb-3">
      <label class="me-2 fw-bold">Status:</label>
      <div class="form-check form-check-inline" *ngFor="let s of statusOptions">
        <input
          class="form-check-input"
          type="radio"
          name="statusFilter"
          [id]="s.value + 'Status'"
          [value]="s.value"
          [(ngModel)]="statusFilter"
          (change)="onStatusChange()"
        />
        <label class="form-check-label" [for]="s.value + 'Status'">
          {{ s.label | titlecase }}
        </label>
      </div>
    </div>

    <!-- Role -->
    <div class="mb-3 d-flex align-items-center">
      <label class="ms-3 me-2 fw-bold">Role:</label>
      <select
        class="form-select d-inline-block w-auto"
        [(ngModel)]="roleFilter"
        (change)="onRoleChange()"
      >
        <option [ngValue]="'all'">All</option>
        <option *ngFor="let role of roleOptions" [ngValue]="role">
          {{ getRoleName(role) }}
        </option>
      </select>
    </div>

    <button class="btn btn-warning" (click)="onBulkUpdateUsers(displayedUsers)">
      Bulk Update
    </button>
    <button class="btn btn-success" (click)="onAddUser()">Add User</button>
  </div>

  <!-- Search -->
  <div class="mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="Search by name, email or phone..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="onSearchChange($event)"
    />
  </div>

  <!-- Table -->
  <div class="table-responsive">
    <table class="table table-striped table-hover table-bordered">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Name</th>
          <th>Age</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Address</th>
          <th>Registered Date</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody *ngIf="!isBulkUpdate">
        <tr *ngFor="let user of displayedUsers; let i = index">
          <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>

          <!-- Inline edit fields -->
          <ng-container
            *ngIf="inlineEditUserId === user.id"
            [formGroup]="inlineEditForm"
          >
            <td>
              <input
                class="form-control form-control-sm"
                formControlName="name"
              />
            </td>
            <td>
              <input
                type="number"
                class="form-control form-control-sm"
                formControlName="age"
              />
            </td>
            <td>
              <input
                type="email"
                class="form-control form-control-sm"
                formControlName="email"
              />
            </td>
            <td>
              <input
                class="form-control form-control-sm"
                formControlName="phone"
              />
            </td>
            <td>
              <input
                class="form-control form-control-sm"
                formControlName="address"
              />
            </td>
            <td>
              <input
                type="date"
                class="form-control form-control-sm"
                formControlName="registeredDate"
              />
            </td>
            <td>
              <select class="form-select form-select-sm" formControlName="role">
                <option *ngFor="let role of roleOptions" [value]="role">
                  {{ getRoleName(role) }}
                </option>
              </select>
            </td>
            <td>
              <select
                class="form-select form-select-sm"
                formControlName="isActive"
              >
                <option [ngValue]="true">Active</option>
                <option [ngValue]="false">Inactive</option>
              </select>
            </td>
            <td>
              <button
                class="btn btn-success btn-sm me-1"
                (click)="onSaveInlineEdit(user)"
              >
                Save
              </button>
              <button
                class="btn btn-secondary btn-sm"
                (click)="onCancelInlineEdit()"
              >
                Cancel
              </button>
            </td>
          </ng-container>

          <!-- Normal view -->
          <ng-container *ngIf="inlineEditUserId !== user.id">
            <td>{{ user.name }}</td>
            <td>{{ user.age }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.phone }}</td>
            <td>{{ user.address }}</td>
            <td>{{ user.registeredDate }}</td>
            <td>
              <span class="badge" [ngClass]="getRoleClass(user.role)">
                {{ getRoleName(user.role) }}
              </span>
            </td>
            <td>
              <span
                class="badge"
                [ngClass]="user.isActive ? 'bg-success' : 'bg-danger'"
              >
                {{ user.isActive ? "Active" : "Inactive" }}
              </span>
            </td>
            <td>
              <button
                class="btn btn-primary btn-sm me-1"
                (click)="onEditUser(user)"
                *ngIf="user.isActive"
              >
                Edit
              </button>
              <button
                class="btn btn-danger btn-sm"
                (click)="onDeleteUser(user)"
                *ngIf="!user.isActive"
              >
                Delete
              </button>
              <button
                class="btn btn-secondary btn-sm me-1"
                (click)="onToggleStatus(user)"
              >
                {{ user.isActive ? "Inactive" : "Active" }}
              </button>
              <button
                class="btn btn-warning btn-sm"
                (click)="onInlineEdit(user)"
              >
                Inline Edit
              </button>
            </td>
          </ng-container>
        </tr>

        <tr *ngIf="displayedUsers.length === 0">
          <td colspan="10" class="text-center">No users found.</td>
        </tr>
      </tbody>

      <tbody *ngIf="isBulkUpdate" [formGroup]="bulkForm">
        <ng-container formArrayName="users">
          <tr
            *ngFor="let group of bulkFormArray.controls; let i = index"
            [formGroupName]="i"
          >
            <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
            <td>
              <input
                class="form-control form-control-sm"
                formControlName="name"
              />
            </td>
            <td>
              <input
                type="number"
                class="form-control form-control-sm"
                formControlName="age"
              />
            </td>
            <td>
              <input
                type="email"
                class="form-control form-control-sm"
                formControlName="email"
              />
            </td>
            <td>
              <input
                class="form-control form-control-sm"
                formControlName="phone"
              />
            </td>
            <td>
              <input
                class="form-control form-control-sm"
                formControlName="address"
              />
            </td>
            <td>
              <input
                type="date"
                class="form-control form-control-sm"
                formControlName="registeredDate"
              />
            </td>
            <td>
              <select class="form-select form-select-sm" formControlName="role">
                <option *ngFor="let role of roleOptions" [value]="role">
                  {{ getRoleName(role) }}
                </option>
              </select>
            </td>
            <td>
              <select
                class="form-select form-select-sm"
                formControlName="isActive"
              >
                <option [ngValue]="true">Active</option>
                <option [ngValue]="false">Inactive</option>
              </select>
            </td>
            <td></td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
  <div *ngIf="isBulkUpdate" class="mt-3">
    <button class="btn btn-success me-2" (click)="onSaveBulkUpdate()">
      Save All
    </button>
    <button class="btn btn-secondary" (click)="onCancelBulkUpdate()">
      Cancel
    </button>
  </div>
  <!-- Pagination -->
  <app-pagination
    [totalItems]="totalUsers"
    [itemsPerPage]="itemsPerPage"
    [currentPage]="currentPage"
    (pageChange)="onPaginationChange($event)"
  ></app-pagination>
</div>
