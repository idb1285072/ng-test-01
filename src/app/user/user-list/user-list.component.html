<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>User List</h2>

    <!-- Status Filter -->
    <div class="mb-3">
      <label class="me-2 fw-bold">Status:</label>
      <div
        class="form-check form-check-inline"
        *ngFor="let s of ['all', 'active', 'inactive']"
      >
        <input
          class="form-check-input"
          type="radio"
          name="statusFilter"
          [id]="s + 'Status'"
          [value]="s"
          [(ngModel)]="statusFilter"
          (change)="onStatusChange()"
        />
        <label class="form-check-label" [for]="s + 'Status'">
          {{ s | titlecase }}
        </label>
      </div>
    </div>

    <!-- Role Filter -->
    <div class="mb-3 d-flex align-items-center">
      <label class="ms-3 me-2 fw-bold">Role:</label>
      <select
        class="form-select d-inline-block w-auto"
        [(ngModel)]="roleFilter"
        (change)="onRoleChange()"
      >
        <option [ngValue]="'all'">All</option>
        <option *ngFor="let role of roleOptions" [ngValue]="role">
          {{ getRoleName(role) }}
        </option>
      </select>
    </div>

    <button class="btn btn-success" (click)="onAddUser()">Add User</button>
  </div>

  <!-- Search -->
  <div class="mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="Search by name, email or phone..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="onSearchChange($event)"
    />
  </div>

  <!-- Table -->
  <div class="table-responsive">
    <table class="table table-striped table-hover table-bordered">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Name</th>
          <th>Age</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Address</th>
          <th>Registered Date</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of displayedUsers; let i = index">
          <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
          <td>{{ user.name }}</td>
          <td>{{ user.age }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.phone }}</td>
          <td>{{ user.address }}</td>
          <td>{{ user.registeredDate }}</td>
          <td>
            <span class="badge" [ngClass]="getRoleClass(user.role)">
              {{ getRoleName(user.role) }}
            </span>
          </td>
          <td>
            <span
              class="badge"
              [ngClass]="user.isActive ? 'bg-success' : 'bg-danger'"
              (click)="onToggleStatus(user)"
              style="cursor: pointer"
            >
              {{ user.isActive ? "Active" : "Inactive" }}
            </span>
          </td>
          <td>
            <button
              class="btn btn-primary btn-sm me-1"
              (click)="onEditUser(user)"
              *ngIf="user.isActive"
            >
              Edit
            </button>
            <button
              class="btn btn-danger btn-sm"
              (click)="onDeleteUser(user)"
              *ngIf="!user.isActive"
            >
              Delete
            </button>
          </td>
        </tr>
        <tr *ngIf="displayedUsers.length === 0">
          <td colspan="10" class="text-center">No users found.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <app-pagination
    [totalItems]="totalUsers"
    [itemsPerPage]="itemsPerPage"
    [currentPage]="currentPage"
    [pageSizes]="pageSizes"
    (pageChange)="onPaginationChange($event)"
  ></app-pagination>
</div>
