<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>User List</h2>
    <div class="mb-3">
      <label class="me-2 fw-bold">Status:</label>
      <div class="form-check form-check-inline">
        <input
          class="form-check-input"
          type="radio"
          name="statusFilter"
          id="allStatus"
          value="all"
          [(ngModel)]="statusFilter"
          (change)="onStatusChange()"
        />
        <label class="form-check-label" for="allStatus">All</label>
      </div>
      <div class="form-check form-check-inline">
        <input
          class="form-check-input"
          type="radio"
          name="statusFilter"
          id="activeStatus"
          value="active"
          [(ngModel)]="statusFilter"
          (change)="onStatusChange()"
        />
        <label class="form-check-label" for="activeStatus">Active</label>
      </div>
      <div class="form-check form-check-inline">
        <input
          class="form-check-input"
          type="radio"
          name="statusFilter"
          id="inactiveStatus"
          value="inactive"
          [(ngModel)]="statusFilter"
          (change)="onStatusChange()"
        />
        <label class="form-check-label" for="inactiveStatus">Inactive</label>
      </div>
    </div>

    <div class="mb-3 d-flex align-items-center">
      <!-- Status radios here -->

      <label class="ms-3 me-2 fw-bold">Role:</label>
      <select
        class="form-select d-inline-block w-auto"
        [(ngModel)]="roleFilter"
        (change)="onRoleChange()"
      >
        <option value="all">All</option>
        <option *ngFor="let role of roleOptions" [value]="role">
          {{ getRoleName(role) }}
        </option>
      </select>
    </div>

    <button class="btn btn-success" (click)="addUser()">Add User</button>
  </div>

  <div class="mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="Search by name or email..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="currentPage = 1"
    />
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-hover table-bordered">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Name</th>
          <th>Age</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Address</th>
          <th>Registed Date</th>
          <th>Role</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of paginatedUsers; let i = index">
          <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
          <td>{{ user.name }}</td>
          <td>{{ user.age }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.phone }}</td>
          <td>{{ user.address }}</td>
          <td>{{ user.registeredDate }}</td>
          <td>
            <span class="badge" [ngClass]="getRoleClass(user.role)">
              {{ getRoleName(user.role) }}
            </span>
          </td>
          <td>
            <span
              class="badge"
              [ngClass]="user.isActive ? 'bg-success' : 'bg-danger'"
              (click)="toggleStatus(user)"
              style="cursor: pointer"
            >
              {{ user.isActive ? "Active" : "Inactive" }}
            </span>
          </td>
          <td>
            <button
              *ngIf="user.isActive"
              class="btn btn-primary btn-sm me-1"
              (click)="editUser(user)"
            >
              Edit
            </button>
            <button
              *ngIf="!user.isActive"
              class="btn btn-danger btn-sm"
              (click)="deleteUser(user)"
            >
              Delete
            </button>
          </td>
        </tr>
        <tr *ngIf="paginatedUsers.length === 0">
          <td colspan="8" class="text-center">No users found.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <!-- <div class="ms-3">
    <label for="itemsPerPage" class="me-2 fw-bold">Users per page:</label>
    <select
      id="itemsPerPage"
      class="form-select d-inline-block w-auto"
      [(ngModel)]="itemsPerPage"
      (ngModelChange)="onItemsPerPageChange()"
    >
      <option *ngFor="let size of pageSizes" [value]="size">
        {{ size }}
      </option>
    </select>

    <nav *ngIf="totalPages() > 1">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <a class="page-link" (click)="changePage(currentPage - 1)"
            >Previous</a
          >
        </li>
        <li
          class="page-item"
          *ngFor="let page of [].constructor(totalPages()); let idx = index"
          [class.active]="currentPage === idx + 1"
        >
          <a class="page-link" (click)="changePage(idx + 1)">{{ idx + 1 }}</a>
        </li>
        <li class="page-item" [class.disabled]="currentPage === totalPages()">
          <a class="page-link" (click)="changePage(currentPage + 1)">Next</a>
        </li>
      </ul>
    </nav>
  </div> -->

  <app-pagination
    [totalItems]="totalUsers"
    [itemsPerPage]="itemsPerPage"
    [currentPage]="currentPage"
    [pageSizes]="pageSizes"
    (pageChange)="onPaginationChange($event)"
  ></app-pagination>
</div>
